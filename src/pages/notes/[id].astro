---
import Base from "@layouts/Base.astro";
import Skiplink from "@components/Skiplink.astro";

import "@styles/_note.scss";

import { getCollection, render } from "astro:content";
// 1. Generate a new path for every collection entry
export async function getStaticPaths() {
  const notes = await getCollection("notes");
  return notes.map((note) => ({
    params: { id: note.id },
    props: { note },
  }));
}
// 2. For your template, you can get the entry directly from the prop
const { note } = Astro.props;
const { Content } = await render(note);

const tags = note.data.tags?.sort((a, b) => a.localeCompare(b)) || [];
---

<Base title={note.data.title} description={note.data.description}>
  <header class="page">
    <Skiplink />
    <nav>
      <a href="/">Home</a>
      <a href="/notes/tags">Tags</a>
      <a href="/search">Search</a>
    </nav>
  </header>
  <main id="main" data-pagefind-body>
    <article>
      <header class="note">
        <h1>{note.data.title}</h1>
        <ul class="tags">
          {
            tags.map((tag) => (
              <li>
                <a class="tag" href={`/notes/tags/${tag}`}>
                  {tag}
                </a>
              </li>
            ))
          }
        </ul>
      </header>
      <div class="note-body">
        <Content />
      </div>
    </article>
  </main>
</Base>
